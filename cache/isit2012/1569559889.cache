{"id":"1569559889","paper":{"title":{"text":"Modeling Biological Circuits with Urn Functions"},"authors":[{"name":"David Lee"},{"name":"Jehoshua Bruck"}],"abstr":{"text":"Abstract\u2014Motivated to understand the role of randomness in biological computation, we study a class of urn models that are characterized by urn functions. At each step, one ball is randomly sampled according to an urn function and replaced with a different colored ball. This process is repeated until the urn contains a single color, at which point the process halts. Such an urn can be thought of as a random switch; depending on the initial ball colors and the urn function, the urn population has some probability of converging to any of the initial ball colors. We ﬁnd that these probabilities have surprisingly simple closed-form solutions and also derive expressions for the switching time.\nWe demonstrate the application of such urn models to bi- ological systems by deriving the urn function for the genetic network controlling the lysis-lysogeny decision in the Lambda phage virus. By applying our results to this system, we then derive an intriguing hypothesis on the role of dimers in genetic switches. Many open questions exist on further generalizations of such urn models and their applications to the understanding of randomness and biological computation."},"body":{"text":"The typical engineering mindset is to eliminate randomness \u2013 deemed as \u2018noise\u2019 \u2013 in a system. Yet, randomness has been steadily playing a larger role in computation and problem solving. Beyond the prevalence of Monte Carlo methods that are used to attack high-dimensional problems[2], there have also been surprising theoretical results indicating that randomized methods may, on occasion, be fundamentally more powerful than deterministic algorithms[10][20].\nThese results are even more thought-provoking when placed next to increasing observations in the biological community of randomness in nature. For example, the ﬁring of neurons is governed by the release of ions into the synpase; these ions arrive in vesicles that have a \u2018vesicle release probability\u2019, which has been hypothesized to play a role in several parts of the neural decision making process[19][22].\nMany of these high-level behaviors can be traced to biolog- ical reactions of the form:\nThe above equation means that when A and B interact with each other, they can be replaced by C with some probability related to the constant k. Typically, such behavior is analyzed with deterministic or continuous approximations, which are accurate for large numbers of molecules. However, studies show that such approximations can overlook signiﬁcant system\nbehaviors when small numbers of molecules are involved, such as in genetic networks of single cells[15][3].\nOne of these behaviors is bistability[21][1], a phenomena where populations of cells or bacteria tend to one of two stable states given the same initial conditions. This behavior is particularly interesting from the perspective of computation because it resembles a switch. A natural question to ask is: how does such switching phenomena arise? How can we design similar mechanisms with a set of randomly interacting agents? An answer to this question would provide a new means for analyzing and designing biological systems and to new approaches for utilizing randomness in computation.\nA natural way to approach this problem is through the literature of urn models. Urn models were mentioned as far back as Bernoulli\u2019s Ars Conjectandi (1713) as a tool for describing different probability distributions. In the model, there is an urn with an initial number of balls, each of which has a color. Balls are then randomly selected with or without replacement to describe different probability distributions.\nIn the 1900s, researchers began to study the dynamics of urn models under repeated sampling and modiﬁcation rules. In the general model, a ball is drawn uniformly at random from the urn. If the ball color is i, then a ij balls of color j are added into the urn, where a ij are entries of a matrix. Many results on the convergence properties of such urns have been shown for various classes of urns (see [16] for an excellent survey as well as the classical Johnston and Kotz book[11] and its sequel[13]). For example, in the original P´olya-Eggenberger urn, balls are either red or blue. Each time a ball is sampled, it is returned along with an additional ball of the same color (a ii = 1, a ij = 0, i = j). Letting R t , B t be the numbers of red and blue balls after t sampling steps and {X t , t ≥ 0} be the stochastic process representing the fraction of red balls\n, it was shown that X t converges almost surely to the beta distribution β(R 0 , B 0 ).\nUrn models have also been generalized in other directions. One particularly interesting model was introduced by Hill et al.[9], who put forward the concept of an urn function. Rather than sampling a red ball with probability X t and a blue ball with probability 1 − X t , they generalize the original P´olya urn by sampling a red ball with probability f (X t ) and a blue ball with probability 1 − f (X t ), where f : [0, 1] → [0, 1] is called\nan urn function. The sampled ball is then returned to the urn along with an additional ball of the same color.\nThere are two speciﬁc urn models that are of special interest to us. In both of these models, the total number of balls remains constant after each sampling and modiﬁcation step.\nThe Ehrenfest urn was introduced in 1907 as a way of modeling diffusion. The urn starts with n balls, each of which are red or blue. Each time a ball is sampled, it is replaced with a ball of the opposite color (a ii = −1 and a ij = 1, i = j). As this process is repeated, R t converges to the binomial distribution Bin(n, 1 2 ).\nThe dual of this urn is the Mabinogian urn[5]. Each time a ball is sampled, it is placed back into the urn and a ball of the opposite color is changed to match the drawn ball\u2019s color (a ii = 1 and a ij = −1, i = j). This replacement rule is unusual in that it cannot be followed indeﬁnitely; once all the balls have converged to the same color, there are no balls of the opposite color to change. Flajolet and Huillet deal with this by halting the random process at this point. They prove that for urns with a ﬁxed fraction of red balls c > 1 2 , the probability that the urn will converge to all red becomes exponentially close to 1 as n → ∞.\nEach of these urns can be represented by a random walk on the integers 0, 1, . . . , n. The random walk starts at some initial position i, which represents the number of red balls in the urn. If a blue ball is changed to a red ball, the random walk moves from i to i+1. Similarly, if a red ball is changed to a blue ball, the random walk moves from i to i − 1. If there is no change in ball color, the random walk stays at i. The probabilities of each of these possible transitions are denoted by p i , q i , and r i respectively. When p i = q i = 1 2 or when p i = p, q i = q, there are several standard martingale methods for deriving properties such as absorption probabilities or convergence times of these random walks[4][7]. More recently, Rudolph also derived closed form expressions for many relevant quantities of these random walks with general parameters p i , q i , and r i [18].\nThe model we deﬁne is a Hill-like generalization of the Mabinogian and Ehrenfest urns where sampling is according to an urn function f : [0, 1] → [0, 1]. At each step,\nIf a ball was sampled, it is replaced with a ball of the opposite color. The urn process halts if it has no more red balls and f (0) > 0 or if it has no more blue balls and f (1) < 1.\nThe main intuition in sampling red balls w.p. f (X t ) and blue balls w.p. f (1 − X t ) (as opposed to 1 − f (X t )) is to use the urn function f to capture structure or symmetry in the interactions. Then, the sampling of red and blue balls should also have a symmetry to it. With this deﬁnition, we can note\nthat the Ehrenfest urn is simply a ﬁxed size urn with the urn function f (p) = p while the Mabinogian urn is a ﬁxed size urn with urn function f (p) = 1 − p.\nIn this paper, we highlight the main results, leaving the details and additional work for the longer version[14]. The remaining sections will be structured as follows:\n1) (Section II) We derive the switching probability of ﬁrst reaching all red or blue. Speciﬁcally, given an initial urn conﬁguration with some urn function f , we ﬁnd the probability that it converges to (or ﬁrst hits) all red or all blue. This distribution is shaped like the cumulative distribution function of a generalized binomial-like dis- tribution and acts as a soft switch for certain f ; that is, if a sufﬁcient majority is red or blue, the urn will converge to the respective majority.\n2) (Section III) We show an application of the above results to a proof-of-principle analysis of Lambda phage, a virus that infects the E. Coli bacterium. We ﬁnd that, with a little work, we are able to describe the lysis-lysogeny decision with an urn function. In addition, we derive a surprising hypothesis on the importance of dimers in genetic switches: if the same negative feedback switch was implemented with monomers, we would no longer get crisp switching behavior.\n3) (Section IV) We summarize other results detailed in the long version: a gaussian approximation to the switch- ing probability, the entropy of a switch, and expected switching time.\nWe are interested in characterizing the switching behavior of a ﬁxed size urn with an arbitrary urn function. Speciﬁcally, let T be the ﬁrst time when the balls are all red or all blue. We want to ﬁnd β n (i) = Pr[R T = n | R 0 = i]. In this section, we ﬁrst deﬁne a useful intermediate operator n . We then derive\nn f for simple functions and prove results on the composition of functions. Finally, we derive switching probabilities of urns in terms of these expressions.\nwill be generalized to allow reals (see Fowler[6] for intuitions), so n k = \t Γ(n+1) Γ(k+1)Γ(n−k+1) . We will also have expressions\nTheorem 1. Let f (p) = p − z, where z ∈ C is a real number such that z = k n for any k = 1, 2, . . . , n. Then,\nn f . We will express the results in terms of δ n (i). Note that since β n (0) = 0, we have β n (i) =\nLemma 1. For a random walk between absorbing boundaries 0 and n, and general transition probabilities p i , q i , and r i for transitions i → i + 1, i → i − 1, and i → i, we have\nThen using the deﬁnition of δ n (i), we can simplify this in the following way:\n(p i + q i + r i )β n (i) = p i β n (i + 1) + q i β n (i − 1) + r i β n (i) p i (β n (i + 1) − β n (i)) = q i (β n (i) − β n (i − 1))\nTheorem 4. Let a ﬁxed size urn sample a red ball with prob- ability k r f (X t ) and a blue ball with probability k b f (1 − X t ), where 0 ≤ k r f (x) + k b f (1 − x) ≤ 1 for 0 ≤ x ≤ 1. Then,\nδ n (i) = 1 Z\nThe behavior of Lambda phage is controlled by a small \u2018molecular program\u2019 written into its DNA. When Lambda phage injects its DNA into the host cell, the host will transcribe proteins encoded by the DNA. These proteins can interact with each other and also affect the future transcription of other proteins. The primary initial decision that Lambda phage needs to make is whether to go into the lytic or the lysogenic cycle.\nIf the host cell is healthy, then Lambda phage would rather enter the lytic cycle where it repeatedly duplicates itself until it bursts the cell and ﬁnds another host to infect. However, if the host cell is unhealthy, or if there are already other infections in the bacterium, then it is likely that there will not be many other host cells to infect. In this case, Lambda phage prefers to enter the lysogenic cycle where it remains dormant until a better time.\nThe genetic circuits of Lambda phage have been thoroughly studied (see [17] for more details). Roughly speaking, there is a portion of the network that is in charge of sensing environmental signals and setting two proteins, cro and cI, at certain concentration levels. As the levels of cro and cI increase, they inhibit the previous proteins, which slowly degrade away.\nThe main decision making portion now ends with a biolog- ical switch implemented by the cro and cI proteins. It can be described in three parts:\n1) The cro and cI proteins can combine to form dimers according to cro + cro cro 2 and cI + cI cI 2 .\n2) The dimers can bind to a promoter region on the Lambda phage DNA; the monomers can be degraded at some rate.\n3) When RNA polymerase (RNAP) attaches to transcribe (create) a new protein, it will transcribe a cro protein if it moves right along the DNA and a cI protein if it moves left along the DNA; however, if a cro 2 dimer is bound, it will block RNAP from transcribing cI. Likewise, if a cI 2 dimer is bound, it will block RNAP from transcribing cro 2 .\nThe system will tend to either all cro proteins or all cI proteins since whichever protein begins to dominate will block further transcription of the opposing protein. Existing proteins of the opposing type will gradually degrade over time according to the degradation rates of the cro and cI monomers. Eventually, if cro dominates, then Lambda phage will enter the lytic cycle. If cI dominates, it will enter the lysogenic cycle.\nBecause of the small numbers of proteins involved, deter- ministic modeling of this system does not accurately predict experimental results and stochastic simulations are the primary method of analyzing such systems[1]. We will show how the behavior of the Lambda phage switch can be modeled with a ﬁxed size urn with an urn function.\nIn our model, we begin the urn process from the time when the other proteins are no longer relevant to the continued production of cro and cI and have reached a total number of proteins where the degradation rate is approximately equal to the transcription rate (so the number of proteins remains roughly constant). In addition,\n1) We approximate transcription and degradation as occur- ing simultaneously.\n2) We assume the rate of the reversible monomer-dimer reaction occurs much faster than the rate of transcription, so that the relative dimer-monomer concentrations can be approximated as in equilibrium.\n3) We assume that most of the time, one of cro 2 or cI 2 is bound to the promoter.\nIt is now easy to see how such a system ﬁts into our model: the cro and cI proteins are the red and blue balls in the urn. For p = #cro #cro+#cI , let d cro (p) and d cI (p) be the probabilities that either cro or cI, respectively, will be the next protein to degrade. Let t cro (p) and t cI (p) be the probabilities that either cro or cI, respectively, will be the next protein to be tran- scribed. Then, for i representing the number of cro proteins, we can calculate the probability of replacing a cro with cI or vice versa. Speciﬁcally, for the corresponding random walk on a line, q i = d cro ( i n )t cI ( i n ) and p i = d cI ( i n )t cro ( i n ).\nFor the following expressions, we will use K 1 and K 2 for the equilibrium constants of cro and cI dimer formation\nrespectively, D 1 and D 2 as the degradation rates of cro and cI respectively, E 1 and E 2 as constants calculated from the binding energies of cro and cI to the DNA, n as the total number of cro and cI in solution, and [n] as the concentration of n in moles per liter, e.g. [n] = moles n V = n V N\n, where V is the volume and N A is avogadro\u2019s number.\nThe ﬁrst observation to make is that despite what we have claimed previously, it is not clear that this system can be modeled by an urn function. Because of the reversible dimer formation reactions, it is not true that d cro/cI and t cro/cI are solely functions of p = i n , the fraction of cro proteins. Indeed, as seen in Lemma 2 below, the expressions are also dependent on the volume of the cell, as captured by [n].\nd cI (p) ∝ D 2 ( 8K 2 [n](1 − p) + 1 − 1)/K 2 t cro (p) ∝ E 1 ( 8K 1 [n]p + 1 − 1) 2 /K 1\nProof: d cro/cI (p) is proportional to the number of cro and cI monomers respectively multiplied by the degradation rates; t cro/cI (p) is proportional to the number of cro 2 and cI 2 dimers multiplied by the binding probabilities. The proof is detailed in the long version.\nTheorem 5 (Probability of Entering the Lytic Cycle). For a E. Coli bacterium infected by a single Lambda phage virus, let n be the total number of cro and cI proteins when the other (cII, cIII, N) protein concentrations have become negligible. Represent the number of cro proteins with i and the number of cI proteins with n − i. Then for small concentrations of protein [n] → 0, the probability of entering the lytic cycle can be found by\nδ n (i) = 1 Z\nj−1 n − 1 j − 1\n1 Z\nj−1 n − 1 j − 1\nThe previous result becomes even more interesting when we consider what happens without dimers. Consider the following situation: suppose that the cI and cro monomers did not form dimers, but could directly bind to the promoter region to suppress transcription of the opposing protein. What would happen then? This question is essentially asking whether the negative feedback of the switch is sufﬁcient for creating switch behavior. Surprisingly, we ﬁnd that in this case, we do not get crisp switching behavior anymore (see Fig. 1).\nTheorem 6. For an E. Coli bacterium infected by a single Lambda phage virus, let n be the total number of cro and cI proteins when the other (cII, CIII, N) protein concentrations have become negligible. Suppose that cro and cI proteins\nFig. 1: We plot the probability of lysis for three different values of D 1 E 2 K 2 D\n: 0.5, 1, and 2. In the case of dimers, we get three different soft switching points. However, in the case of monomers, we either get lysis or lysogeny with probability ∼ 1, or a linear transition from lysogeny to lysis.\ndid not form dimers, but directly bound to the promoter to inhibit transcription of the opposing protein. Then for small concentrations of protein [n] → 0, the probability of entering the lytic cycle can be found by\n1 Z\nThis is particularly interesting in light of the ubiquity of dimers in genetic networks[12][8]. Perhaps dimers are not just needed for their \u2018device level\u2019 functionalities. The dimer formation process itself may be essential for a successful implementation of various phenomena.\nWe show that the generalized binomial expressions of Theorem 1 can be approximated by a gaussian and we derive a simple relation of the variance to the urn function. This gives another interpretation to the urns: by using different urn functions, a small number of molecules in an urn may be able to approximately simulate a much larger number of coin ﬂips.\nIn addition, this approximation allows us to also calculate bounds for 1 n n i=0 H(β n (i)), which is the average switching entropy of the urn.\nIt is also important to characterize the time it takes to switch. In the longer version, we derive bounds on the expected switching time for ﬁxed size urns which sample red balls with probability f (X t ) and blue balls with probability f (1 − X t ).\nThere are several directions for extending this work. On the model itself, it would be great to generalize the results to multi-colored urns (with multivariable urn functions) or to allow more types of transitions. It would also be interesting to use urn functions to analyze other behaviors, such as oscillations. Finally, it would be interesting to see what other algorithmic applications may arise from ﬁxed size urns with urn functions.\nThe authors would like to thank Tony Wong for helpful discussions on the switching probability and Persi Diaconis for pointing us to the P´olya urn literature. This work was supported in part by the Molecular Programming Project funded by the NSF Expeditions in Computing Program under grant CCF-0832824."},"refs":[{"authors":[],"title":{"text":"A Arkin, J Ross, and H McAdams"}},{"authors":[],"title":{"text":"P Diaconis"}},{"authors":[],"title":{"text":"M Elowitz"}},{"authors":[],"title":{"text":"W Feller"}},{"authors":[],"title":{"text":"P Flajolet and T Huillet"}},{"authors":[],"title":{"text":"D Fowler"}},{"authors":[],"title":{"text":"G Grimmett and D Stirzaker"}},{"authors":[],"title":{"text":"C Heldin"}},{"authors":[],"title":{"text":"B Hill, D Lane, and W Sudderth"}},{"authors":[],"title":{"text":"M Jerrum, A Sinclair, and E Vigoda"}},{"authors":[],"title":{"text":"N Johnson and S Kotz"}},{"authors":[],"title":{"text":"J Klemm, S Schreiber, and G Crabtree"}},{"authors":[],"title":{"text":"S Kotz and N Balakrishnan"}},{"authors":[],"title":{"text":"D Lee and J Bruck"}},{"authors":[],"title":{"text":"H McAdams and A Arkin"}},{"authors":[],"title":{"text":"R Pemantle"}},{"authors":[],"title":{"text":"M Ptashne"}},{"authors":[],"title":{"text":"G Rudolph"}},{"authors":[],"title":{"text":"E Schneidman, B Freedman, and I Segev"}},{"authors":[],"title":{"text":"D Soloveichik, M Cook, E Winfree, and J Bruck"}},{"authors":[],"title":{"text":"J Veening, W Smits, and O Kuipers"}},{"authors":[],"title":{"text":"T Yang and M Shadlen"}}]},"file":{"jsonClass":"File","file":"/home/arnfred/Code/trailhead/resources/isit2012/1569559889.pdf"},"links":[{"id":"1569566527","weight":3},{"id":"1569565663","weight":2},{"id":"1569565377","weight":2},{"id":"1569566385","weight":2},{"id":"1569564605","weight":3},{"id":"1569566321","weight":3},{"id":"1569565489","weight":3},{"id":"1569565711","weight":2},{"id":"1569565091","weight":6},{"id":"1569556029","weight":2},{"id":"1569564481","weight":2},{"id":"1569565171","weight":2},{"id":"1569565771","weight":2},{"id":"1569566999","weight":2},{"id":"1569556091","weight":2},{"id":"1569566497","weight":2},{"id":"1569565897","weight":2},{"id":"1569566343","weight":6},{"id":"1569566679","weight":2},{"id":"1569561085","weight":2},{"id":"1569559565","weight":2},{"id":"1569563307","weight":2},{"id":"1569566657","weight":2},{"id":"1569558859","weight":2},{"id":"1569565365","weight":6},{"id":"1569567015","weight":2},{"id":"1569558901","weight":2},{"id":"1569565427","weight":2},{"id":"1569566513","weight":2},{"id":"1569554971","weight":2},{"id":"1569565501","weight":12},{"id":"1569565055","weight":3},{"id":"1569566603","weight":4},{"id":"1569567029","weight":5},{"id":"1569565467","weight":3},{"id":"1569566673","weight":10},{"id":"1569565739","weight":2},{"id":"1569565545","weight":2},{"id":"1569566245","weight":2},{"id":"1569560503","weight":4},{"id":"1569566901","weight":3},{"id":"1569561623","weight":3},{"id":"1569565155","weight":2},{"id":"1569565571","weight":2},{"id":"1569565385","weight":3},{"id":"1569565575","weight":2},{"id":"1569564919","weight":4},{"id":"1569564595","weight":3},{"id":"1569566917","weight":2},{"id":"1569564703","weight":2},{"id":"1569563975","weight":2},{"id":"1569566487","weight":3},{"id":"1569566001","weight":4},{"id":"1569567483","weight":2},{"id":"1569565367","weight":3},{"id":"1569565389","weight":2},{"id":"1569566057","weight":3},{"id":"1569562367","weight":6},{"id":"1569567013","weight":3},{"id":"1569565635","weight":2},{"id":"1569565373","weight":3},{"id":"1569566615","weight":3},{"id":"1569566727","weight":2}],"meta":{"jsonClass":"HashMap$HashTrieMap","sessionid":"S15.T9.4","endtime":"11:10","authors":"David Lee, Jehoshua Bruck","date":"1341571800000","papertitle":"Modeling Biological Circuits with Urn Functions","starttime":"10:50","session":"S15.T9: Strings, Sorting, and Biology","room":"Stratton West Lounge (201)","paperid":"1569559889"},"cluster":{"jsonClass":"HashMap$HashTrieMap","spectral6":"3","spectral43":"29","spectral28":"27","spectral32":"4","spectral14":"13","spectral20":"2","spectral9":"6","spectral25":"19","spectral42":"32","spectral3":"1","spectral47":"30","spectral17":"3","louvain":"558","spectral36":"14","spectral39":"29","spectral10":"4","spectral15":"5","spectral33":"9","spectral5":"2","spectral21":"20","spectral44":"30","spectral26":"16","spectral40":"21","spectral8":"2","spectral11":"1","spectral4":"3","spectral37":"8","spectral48":"12","spectral22":"4","spectral23":"11","spectral12":"7","spectral50":"30","spectral19":"8","spectral34":"1","spectral45":"20","spectral7":"5","spectral49":"35","spectral38":"14","spectral24":"22","spectral13":"1","spectral31":"24","spectral29":"22","spectral35":"7","spectral30":"23","spectral41":"19","spectral27":"4","spectral18":"14","spectral46":"30","spectral2":"0","spectral16":"14"}}
